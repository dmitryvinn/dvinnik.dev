{"componentChunkName":"component---src-templates-article-index-js","path":"/articles/2023/lightning-fast-testing-for-salesforce-with-applitools-and-testzeus/","result":{"data":{"markdownRemark":{"html":"<p><img src=\"./cover.jpg\" alt=\"cover\"></p>\n<p><em>By Dmitry Vinnik</em></p>\n<p><em>Originally posted <a href=\"https://applitools.com/blog/lightning-fast-testing-for-salesforce-with-applitools-and-testzeus/\">here</a>.</em></p>\n<p>Salesforce is not just one of the most popular CRM platforms; it’s an ecosystem that combines almost anything that a business needs under one roof. Gone are the days when entrepreneurs were willing to use hundreds of different tools through separate services. Nowadays, companies want everything they need in one product, under one domain – think messenger, documentation, product site, analytics, and more. That’s what Salesforce provides to its customers – a single place where businesses can conduct their work.</p>\n<p>Since its founding in 1999, Salesforce has undergone many changes. While it’s natural for a product to evolve to meet its customers’ demands, in 2018, Salesforce introduced its Lightning Platform, which was a complete overhaul of the entire user experience at Salesforce.</p>\n<p>With a highly dynamic platform like Salesforce, developers who create apps and integrations on Salesforce need a reliable way to test their applications. Test automation and, more specifically, visual testing ensures a scalable way of validating core functionality that your customers rely on.</p>\n<p><strong>Why Testing Matters</strong></p>\n<p>As with any product, we want to be confident that our application doesn’t break overnight. We need to ensure that the behavior that our customers are used to stays the same unless we intentionally want to introduce a change. This reason is why end-to-end testing is vital since it covers the core user workflows like logging in, creating an account, buying an item, and many other use cases.</p>\n<p>While other levels of testing, like unit or integration tests, are fantastic for ensuring a short feedback loop for our developers, end-to-end tests give us the highest level of confidence that the overall product continues to work well for our customers.</p>\n<p>Suppose we are working within the Salesforce ecosystem. In that case, we need a reliable way to test our Salesforce product to ensure that our Salesforce integration or a custom app is fully functional. </p>\n<p>This post looks at how TestZeus, a test automation library for Salesforce apps, and Applitools Visual AI can provide us with an optimized, efficient, and deterministic way to automate our customer scenarios by writing less code yet increasing test coverage.</p>\n<p><strong>Introducing TestZeus for More Effective Test Automation for Salesforce</strong></p>\n<p>TestZeus is an open-source UI automation framework that provides an efficient way to find elements on Salesforce apps. It relies on what’s called AutoLocators strategy that uses the Salesforce Developer API to find UI elements on the webpage. </p>\n<p>In order for us to properly demonstrate how TestZeus works, we first need to set up our Salesforce environment.</p>\n<p><strong>Setting up Salesforce Environment</strong></p>\n<p>Salesforce is an entire ecosystem created around its Customer Relationship Management (CRM) system. And as fun as testing in production could be, we should make a development environment with Salesforce.</p>\n<p>Luckily, Salesforce has a highly engaging community of developers and many learning resources. One of the community members has covered in great detail how to setup what’s called a Salesforce Developer Edition instance. In this article, we will only focus on the core parts of the process (for more information, you can read the community forum).</p>\n<p>After you navigate to the signup page, you will need to fill out some basic information about your account.</p>\n<p>Immediately after you sign up, you will receive a confirmation email that will look something like this.</p>\n<p>Apart from pressing “Verify Account” button, you will need to make sure to capture your instance’s URL (HOME_URL as we will call it in the test properties) and username (USERNAME in the test properties):</p>\n<p>When you first attempt to log into the Salesforce instance, it will prompt you to create a password which we will later use as the PASSWORD property in the tests.</p>\n<p><strong>Using Salesforce Developer API</strong></p>\n<p>TestZeus requires us to use the Salesforce Developers API. For this article, we will need a security token for your account and a consumer key/secret combination.</p>\n<p>Without diving into too many details, a security token is another way to authenticate the Salesforce Developer API. At the same time, a consumer key/secret combination lets Salesforce control the scope of your API calls.</p>\n<p><strong>Getting a security token</strong></p>\n<p>The security token is one of the components required for API authentication. To get it for the first time, you need to “Reset Security Token” through the Salesforce UI. This video goes through details on how to do it step-by-step. Ultimately, you will receive an email containing a security token that we will use as SECURITY_TOKEN properties in our tests.</p>\n<p><strong>Acquiring a consumer key/secret combination</strong></p>\n<p>The last piece of information we need to authenticate your tests successfully is what’s called a Consumer Key and Secret. We will need to create a Connected app that will, in turn, provide the authentication details. You can think of this step as a way to control the permission scope of the API usage.\nThis video walks through the steps to create the Connected app and retrieve its authentication details. In short, we need first need to create a New Connected App.</p>\n<p>Then fill in all the required fields, enable OAuth settings and choose the necessary scope (as shown in the video):\nFollowing the app’s creation, you must click “Manage Consumer Details” to retrieve the authentication information:\nThis new window will show us the exact data we need: a Consumer Key and a Consumer Secret</p>\n<p>In our test, we will later use this information as CONSUMER<em>KEY and CONSUMER</em>SECRET properties.</p>\n<p><strong>Functional Testing with TestZeus</strong></p>\n<p>Now with all the necessary information and demo environment set up, we can proceed with writing our tests. For this article, we put together a small project that you can see here. We will first walk through this code to show how to use a TestZeus framework for testing a Salesforce application and, later, add a visual testing component using Applitools.</p>\n<p><strong>Preparing Test Scenario</strong></p>\n<p>For our article, we will do a primary case of validating UI for a test account we create beforehand.</p>\n<p>In your Salesforce instance, navigate to Accounts and click “New account”.</p>\n<p>Then we will create an Account named “Test Account,” and our test scenario is ready to be used.</p>\n<p><strong>Setting Up TestZeus</strong></p>\n<p>First, we need to clone our demo project:</p>\n<p><code>git clone git@github.com:dmitryvinn/applitools-testzeus-demo.git</code></p>\n<p>Our demo project uses Java programming language and Maven as its build system. Hence, we encourage you to use an IDE like Intellij IDEA to simplify the development experience.</p>\n<p>After you open the project with your IDE of choice, you must use Maven to build the project and download all necessary dependencies. One of the critical dependencies we are relying on for this part of the article is TestZeus dependency:</p>\n<pre><code>&#x3C;dependency>\n            &#x3C;groupId>com.testzeus&#x3C;/groupId>\n            &#x3C;artifactId>Test_Zeus&#x3C;/artifactId>\n            &#x3C;version>1.0.2&#x3C;/version>\n&#x3C;/dependency>\n</code></pre>\n<p>The next step is to fill out all the required properties we will use in our tests in the config.properties file. So far, we have covered all but the APPLITOOL_KEY property, which we will discuss later.</p>\n<p>Writing Our First TestZeus Test\nIn this article, we explore a simple use case of validating an account we created beforehand.</p>\n<p>For brevity purposes, we will skip going into the general Selenium Webdriver code and focus only on specific details around TestZeus.</p>\n<p>First, we need to authenticate our test, so we can use the Salesforce Developer API to work with data objects, retrieve specific selectors, and more.</p>\n<p>In BaseTest.java, we have the following method we invoke in our setup() to handle authentication:</p>\n<pre><code>private void authenticateUser() {\n    HTTPClientWrapper.SFLogin_API(HOME_URL, TOKEN_GRANT_URL, CONSUMER_KEY, CONSUMER_SECRET, USERNAME, PASSWORD + SECURITY_TOKEN);\n}\n</code></pre>\n<p>Then, we need to create a new test named AccountsTest.java where we will have our #findTestAccount() test case.</p>\n<p>We will begin our test scenario by Arranging it, or in other words, by setting up our test case.</p>\n<p>We will first initiate an SFPageBase with the current webdriver instance and then navigate to the home URL:</p>\n<pre><code>final SFPageBase salesforcePage = new SFPageBase(driver);\n\nsalesforcePage.openHomepage(HOME_URL);\nsalesforcePage.maximize();\n</code></pre>\n<p>Now, we will proceed to log into our demo environment:</p>\n<pre><code>driver.findElement(By.id(\"username\")).sendKeys(USERNAME);\ndriver.findElement(By.id(\"password\")).sendKeys(PASSWORD);\n\nfinal WebElement loginButton = driver.findElement(By.id(\"Login\"));\nsalesforcePage.safeClick(loginButton);\n</code></pre>\n<p>In the next step, we will transition into the Act portion of the test case, starting with test-specific actions.</p>\n<p>We will use TestZeus’ SFBasePage to navigate to the Accounts tab and open our “Test Account”:</p>\n<pre><code>salesforcePage.appLauncher(\"Account\");\n\nfinal WebElement testAccountItem = driver.findElement(By.xpath(String.format(\"//a[@title='%s']\", TEST_ACCOUNT_NAME)));\n salesforcePage.safeClick(testAccountItem);\n</code></pre>\n<p>Lastly, in the Assert stage of the test case, we will validate one of the fields shown on the UI:</p>\n<p><code>driver.findElement(By.xpath(\"//p[text()='Account Owner']\"));</code></p>\n<p>As we can see, TestZeus helps simplify waiting for UI elements, navigation, and working with Salesforce Objects.</p>\n<p>Now with this highly efficient way of locating UI elements using TestZeus, we can take our test automation to the next level with Applitools and visual testing.</p>\n<p>Taking Next Steps: Functional Testing for Salesforce apps with Applitools and TestZeus\nFunctional testing is a type of testing that focuses on the core functionalities of an application while following predetermined steps. In other words, it’s a way to evaluate a scenario with two potential outcomes, failure or success, using the same input.</p>\n<p>While there are many functional testing levels like unit or integration testing, end-to-end tests give us the highest confidence level in customer use cases. It’s also one of the most expensive types of testing since it takes a lot of effort to write assertions for every single element of the app and then keep maintaining this workflow. But not with Applitools and Visual AI analysis.</p>\n<p>With the Visual AI in Applitools Eyes, rather than writing assertions focused on just one object, Applitools lets us capture the entire web page or mobile app screen, then send it to the Applitools Visual AI for analysis.</p>\n<p><strong>Simplifying Functional Testing with Applitools</strong></p>\n<p>This visual testing allows us to see our app from our customers’ points of view. And that’s where the Applitools Visual AI comes in! This AI-based visual testing tool can enhance the existing end-to-end test coverage to ensure our app’s user experience conforms to the expected design.</p>\n<p>Using AI algorithms, Applitools allows developers, testers, and product/business teams to effectively compare visual elements, with corresponding baselines, across various screens to find visible defects in your test environments. This way, you can prevent functional and visual defects from escaping to production and affecting your customers negatively.</p>\n<p>Applitools has integrations with numerous testing platforms like Cypress, WebdriverIO, Selenium, and many others. This article will showcase Applitools with TestZeus to add visual test coverage to our Salesforce app.</p>\n<p><strong>Setting up Applitools</strong></p>\n<p>Applitools has fantastic documentation on how to get started with the project. For this article, we will first need to register with Applitools and retrieve an APPLITOOLS<em>API</em>KEY for our config.properties.</p>\n<p>We will also add the following dependency to our Maven build:</p>\n<pre><code>      &#x3C;dependency>\n            &#x3C;groupId>com.applitools&#x3C;/groupId>\n            &#x3C;artifactId>eyes-selenium-java5&#x3C;/artifactId>\n            &#x3C;version>5.39.0&#x3C;/version>\n        &#x3C;/dependency>\n</code></pre>\n<p>Now, we are all set to write our test cases with Applitools.</p>\n<p>Visual Testing with Applitools and TestZeus\nBy using this great starter project, we can quickly enhance our existing test suite with visual test automation using Applitools.</p>\n<p>First, we will create a new test class named AccountsApplitoolsTest.java. Then, we will need to add some additional setup code to enable Applitools and its Ultrafast Grid, so we can scale our tests in the future.</p>\n<pre><code>    @BeforeAll\n    public static void setUpConfigAndRunner() {\n        runner = new VisualGridRunner(new RunnerOptions().testConcurrency(1));\n\n        config = new Configuration();\n        config.setApiKey(APPLITOOLS_API_KEY);\n\n        final BatchInfo batch = new BatchInfo(\"Salesforce Accounts Page Tests with TestZeus\");\n        config.setBatch(batch);\n\n        config.addBrowser(1024, 768, BrowserType.CHROME);\n    }\n</code></pre>\n<p>In the above code snippet, we set our tests to be run one at a time (the limit for free Applitools accounts), specified the Applitools API Key, and chose Chrome as our test browser.</p>\n<p>The next step is to “open the eyes” which is an API terminology for starting visual testing for our test suite:</p>\n<pre><code>    @BeforeEach\n    public void openBrowserAndEyes(TestInfo testInfo) {\n        eyes = new Eyes(runner);\n        eyes.setConfiguration(config);\n\n        eyes.open(\n                driver,\n                \"TestZeus Demo\",\n                testInfo.getDisplayName());\n    }\n</code></pre>\n<p>Now, similarly to the previous example with TestZeus, we will have a new test named findTestAccount(). One of the best things about using Applitools is that we don’t have to make any additional changes to our test scenario! So everything from Arrange to Act steps will remain the same:</p>\n<pre><code>    @Test\n    public void findTestAccount() throws Exception {\n\n        // Arrange\n        final SFPageBase salesforcePage = new SFPageBase(driver);\n\n        salesforcePage.openHomepage(HOME_URL);\n        salesforcePage.maximize();\n\n        driver.findElement(By.id(\"username\")).sendKeys(USERNAME);\n        driver.findElement(By.id(\"password\")).sendKeys(PASSWORD);\n\n        final WebElement loginButton = driver.findElement(By.id(\"Login\"));\n        salesforcePage.safeClick(loginButton);\n\n        // Act\n        salesforcePage.appLauncher(\"Account\");\n\n        final WebElement testAccountItem = driver.findElement(By.xpath(String.format(\"//a[@title='%s']\", TEST_ACCOUNT_NAME)));\n        salesforcePage.safeClick(testAccountItem);\n</code></pre>\n<p>The only change we will need to make is in the Assert part of the test case. Here, we will have code to validate that the page loaded correctly and that its layout matches between test runs. We could also validate a snapshot of the entire page with Applitools, but Salesforce apps are known to have varying load times. So the layout match level helps to avoid false positives:</p>\n<p><code>eyes.check(Target.window().fully().withName(\"Test Account\").layout());</code></p>\n<p>We are almost done! To make sure that our Applitools tests are closed correctly after their run, we will need to add this @AfterEach method:</p>\n<pre><code>public void cleanUpTest() {\n        eyes.closeAsync();\n}\n</code></pre>\n<p>With this, our first test with Applitools and TestZeus for the Salesforce app is complete. Let’s visit our Applitools Dashboard to review the results:</p>\n<p><strong>Wrapping Up</strong></p>\n<p>Salesforce is an ever changing ecosystem of apps and products under one platform. That’s why tools like TestZeus are beneficial in simplifying both the creation and, more critically, maintenance of our tests.</p>\n<p>Combined with testing automation platforms like Applitools, we can take our testing infrastructure to the next level by focusing on scale, cross-platform support, and a short feedback loop.</p>","frontmatter":{"title":"Lightning Fast Testing for Salesforce with Applitools and TestZeus","description":"This post looks at how TestZeus, a test automation library for Salesforce apps, and Applitools Visual AI can provide us with an optimized way to automate our customer scenarios by writing less code.","canonicalUrl":"https://applitools.com/blog/lightning-fast-testing-for-salesforce-with-applitools-and-testzeus/","date":"Feb 23, 2023"}}},"pageContext":{"slug":"/articles/2023/lightning-fast-testing-for-salesforce-with-applitools-and-testzeus/","previous":{"fields":{"slug":"/articles/2023/open-source-2022-year-in-review/"},"frontmatter":{"title":"Lightning Fast Testing for Salesforce with Applitools and TestZeus"}},"next":null}},"staticQueryHashes":["2125292342","2915660680","3649515864","63159454"]}